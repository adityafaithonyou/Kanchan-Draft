/* Performance Optimizations for Responsive Design */

/* CSS Custom Properties for dynamic values */
:root {
  --vh: 1vh;
  --base-font-size: 16px;
  --scroll-offset: 0px;
}

/* Optimize animations and transitions */
* {
  box-sizing: border-box;
}

*,
*::before,
*::after {
  animation-fill-mode: both;
}

/* GPU acceleration for smooth animations */
.cf-features-section-2-grid-cell,
.div-block-8,
.nav-menu-wrapper,
.button-primary,
.f-button-primary {
  transform: translateZ(0);
  will-change: transform;
}

/* Optimize scroll performance */
.navbar {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  z-index: 1000;
  transition: background-color 0.3s ease, box-shadow 0.3s ease;
  background-color: transparent;
}

.navbar.scrolled {
  background-color: rgba(0, 0, 0, 0.9);
  backdrop-filter: blur(10px);
  box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1);
}

/* Optimize layout shifts */
.cf-service-image,
.f-image-cover {
  background-color: #f5f5f5;
  min-height: 200px;
}

/* Loading states */
.js-loaded .cf-features-section-2-grid-cell {
  animation: fadeInUp 0.6s ease forwards;
}

.js-loaded .div-block-8 {
  animation: fadeInUp 0.6s ease forwards;
  animation-delay: calc(var(--index, 0) * 0.1s);
}

@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(30px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* Touch device optimizations */
.touch-device .cf-features-section-2-grid-cell:hover {
  transform: none;
}

.touch-device .cf-features-section-2-grid-cell.touch-active {
  transform: scale(0.98);
  transition: transform 0.1s ease;
}

/* Reduce motion for accessibility */
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
  
  .js-loaded .cf-features-section-2-grid-cell,
  .js-loaded .div-block-8 {
    animation: none;
  }
}

/* Critical rendering path optimization */
.above-fold {
  contain: layout style paint;
}

/* Optimize font loading */
.heading,
.heading-15,
.heading-17 {
  font-display: swap;
}

/* Container queries for modern browsers */
@supports (container-type: inline-size) {
  .cf-features-section-2-wrapper {
    container-type: inline-size;
  }
  
  @container (max-width: 600px) {
    .cf-features-section-2-grid {
      grid-template-columns: 1fr;
    }
  }
  
  @container (min-width: 601px) and (max-width: 900px) {
    .cf-features-section-2-grid {
      grid-template-columns: repeat(2, 1fr);
    }
  }
  
  @container (min-width: 901px) {
    .cf-features-section-2-grid {
      grid-template-columns: repeat(3, 1fr);
    }
  }
}

/* Intersection Observer loading states */
.fade-in {
  opacity: 0;
  transform: translateY(20px);
  transition: opacity 0.6s ease, transform 0.6s ease;
}

.fade-in.visible {
  opacity: 1;
  transform: translateY(0);
}

/* Optimize background images for performance */
.home-hero-stack,
.project-hero-stack,
.taljai-hero-stack-copy,
.parshwanagar-hero-stack-copy,
.almanova-hero-stack-copy,
.one-only-hero-stack-copy {
  background-attachment: scroll;
  will-change: transform;
}

/* Mobile-specific performance optimizations */
@media screen and (max-width: 768px) {
  /* Reduce complexity on mobile */
  .cf-features-section-2-grid-cell {
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  }
  
  .cf-features-section-2-grid-cell:hover {
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  }
  
  /* Optimize touch scrolling */
  .nav-menu-wrapper {
    -webkit-overflow-scrolling: touch;
    overscroll-behavior: contain;
  }
}

/* Optimize for very small screens */
@media screen and (max-width: 360px) {
  /* Reduce visual complexity */
  .div-block-8 {
    box-shadow: 0 1px 4px rgba(0,0,0,0.1);
  }
  
  /* Optimize text rendering */
  .heading,
  .heading-15,
  .heading-17 {
    text-rendering: optimizeSpeed;
  }
}

/* High refresh rate display optimization */
@media screen and (min-refresh-rate: 120Hz) {
  .cf-features-section-2-grid-cell,
  .div-block-8,
  .button-primary {
    transition-duration: 0.1s;
  }
}

/* Dark mode support */
@media (prefers-color-scheme: dark) {
  .cf-service-image {
    background-color: #2a2a2a;
  }
}

/* Print optimization */
@media print {
  .navbar,
  .menu-button,
  .nav-menu-wrapper {
    display: none !important;
  }
  
  .cf-features-section-2-grid {
    display: block;
  }
  
  .cf-features-section-2-grid-cell {
    break-inside: avoid;
    margin-bottom: 1rem;
    box-shadow: none;
    border: 1px solid #ddd;
  }
}

/* Focus management for keyboard navigation */
.skip-link {
  position: absolute;
  top: -40px;
  left: 6px;
  background: #000;
  color: #fff;
  padding: 8px;
  text-decoration: none;
  border-radius: 4px;
  z-index: 10000;
}

.skip-link:focus {
  top: 6px;
}

/* Optimize for foldable devices */
@media screen and (min-width: 768px) and (max-width: 1024px) and (orientation: portrait) {
  .cf-features-section-2-grid {
    grid-template-columns: repeat(2, 1fr);
  }
}

/* Network-aware optimizations */
@media (prefers-reduced-data: reduce) {
  .home-hero-stack,
  .project-hero-stack,
  .taljai-hero-stack-copy,
  .parshwanagar-hero-stack-copy,
  .almanova-hero-stack-copy,
  .one-only-hero-stack-copy {
    background-image: none;
    background-color: #333;
  }
}